<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>打字消消樂</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" integrity="sha384EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
  </head>
  <body>
    <div id="container" tabindex="0" class="blockquote text-nowrap"></div>

    <script>
      const container = document.getElementById('container');
      let firstChar = container.textContent.charAt(0);

      function getRandomChars() {
        const chars = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
        let result = "";
        const numChars = Math.floor(Math.random() * 3) + 1;
        for (let i = 0; i < numChars; i++) {
          result += chars.charAt(Math.floor(Math.random() * chars.length));
        }
        return result;
      }

      let randChars = getRandomChars();
      window.addEventListener("load", function() {
        container.textContent = randChars + container.textContent.substring(randChars.length);
      });

      window.addEventListener("keyup", function(e) {
        console.log(e.key);
        if (e.key === 'Escape') {
          container.textContent = "";
        } 
        else if (e.key === 'Backspace') {
          const str = container.textContent;
          if (str.length > 0) {
            container.textContent = str.substring(0, str.length - 1);
          }
        } 
        else {
          firstChar = container.textContent.charAt(0);
          if (e.key === firstChar) {
            if (container.textContent.length > 1) {
              container.textContent = container.textContent.substring(1);
              container.textContent += getRandomChars();
            } 
            else {container.textContent = getRandomChars();
            }
          }
        }
      });
    </script>
  </body>
</html>

